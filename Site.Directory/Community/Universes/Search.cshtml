@page
@model RoleplayersGuild.Site.Directory.Community.Universes.SearchModel
@{
    ViewData["Title"] = "Universes";
    Layout = "_Layout2Col";
}

@section cphLeftCol {
    @await Component.InvokeAsync("FilterNav", new { selectedGenreIds = Model.SelectedGenreIds })
}

@section cphRightCol {
    <div class="row g-2 mb-3">
        <div class="col-sm-4 col-xl-3">
            <a asp-page="/User-Panel/Index" class="btn btn-secondary w-100">Back To User Panel</a>
        </div>
        <div class="col-sm-4 col-xl-3 offset-xl-6">
            <a asp-page="/User-Panel/My-Universes/Edit" class="btn btn-success w-100">
                <i class="bi bi-plus"></i> New Universe
            </a>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0">Universes</h5>
        </div>
        <div class="card-body">
            <p>Below is a list of all Universes found within the RPG. You can use this screen to look for a universe you're interested in or create one.</p>

            <div class="p-3 mb-3 bg-light border rounded">
                <form method="get" class="row g-2">
                    @foreach (var genreId in Model.SelectedGenreIds)
                    {
                        <input type="hidden" name="SelectedGenreIds" value="@genreId" />
                    }
                    <div class="col-sm-10">
                        <input asp-for="SearchTerm" class="form-control" placeholder="Universe Name or ID" />
                    </div>
                    <div class="col-sm-2">
                        <button type="submit" class="btn btn-primary w-100">Search</button>
                    </div>
                </form>
            </div>

            <div class="WritingContentList">
                @if (Model.UniversesResult != null && Model.UniversesResult.Items.Any())
                {
                    @foreach (var universe in Model.UniversesResult.Items)
                    {
                        <div class="WritingContentBoxContainer">
                            <div class="WritingContentBox">
                                <a asp-page="./View" asp-route-id="@universe.UniverseId" class="WritingContentName">@universe.UniverseName &raquo;</a>
                                <div class="WritingContentDetails">
                                    <ul class="Info">
                                        <li><span>Source:</span> @universe.SourceType</li>
                                        <li><span>Rating:</span> @universe.ContentRating</li>
                                        <li><span>Characters:</span> @universe.CharacterCount</li>
                                        <li><span>Chat Rooms:</span> @universe.ChatRoomCount</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <p>No universes found matching your criteria.</p>
                }

                @if (Model.UniversesResult != null)
                {
                    <partial name="_PagingControls" model="Model.UniversesResult" />
                }
            </div>
        </div>
    </div>
}